#!/usr/bin/env python
"""Periodic updating of resources from EGI's AppDB"""

from __future__ import print_function
import configparser
import logging
from logging.handlers import RotatingFileHandler
import os
import sys
import time

from imc import config

# Configuration
CONFIG = config.get_config()

# Logging
handler = RotatingFileHandler(filename=CONFIG.get('logs', 'filename').replace('.log', '-cleaner.log'),
                              maxBytes=int(CONFIG.get('logs', 'max_bytes')),
                              backupCount=int(CONFIG.get('logs', 'num')))
formatter = logging.Formatter('%(asctime)s %(levelname)s [%(name)s] %(message)s')
handler.setFormatter(formatter)
logger = logging.getLogger('checks')
logger.addHandler(handler)
logger.setLevel(logging.INFO)

if __name__ == "__main__":
    while True:

        time.sleep(int(CONFIG.get('updates', 'egi')))
